// ğŸ“‚ prisma/schema.prisma

// ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
datasource db {
  provider = "postgresql" // PostgreSQLì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ "postgresql"ë¡œ ì„¤ì •
  url      = env("DATABASE_URL") // í™˜ê²½ ë³€ìˆ˜ì—ì„œ DB ì—°ê²° URLì„ ê°€ì ¸ì˜´
}

// Prisma í´ë¼ì´ì–¸íŠ¸ ìƒì„± ì„¤ì •
generator client {
  provider = "prisma-client-js"
}

model Post {
  id        String    @id @default(uuid()) @map("id")
  title     String
  content   String
  imageUrl  String?   @map("image_url") // DB ì»¬ëŸ¼ëª…ì€ image_url, Prisma ëª¨ë¸ í•„ë“œëª…ì€ imageUrl
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  userId    String
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade) // â˜…â˜…â˜… onDelete: Cascade ì¶”ê°€ ë° í™•ì¸

  comments  Comment[]
  likes     Like[]

  @@map("post") // â˜…â˜…â˜… ì†Œë¬¸ì ë‹¨ìˆ˜í˜• í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ë§¤í•‘
}

model User {
  id        String    @id @default(uuid()) @map("id")
  email     String    @unique
  name      String?
  password  String
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")

  posts     Post[]
  comments  Comment[]
  likes     Like[]

  @@map("user") // â˜…â˜…â˜… ì†Œë¬¸ì ë‹¨ìˆ˜í˜• í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ë§¤í•‘
}

model Comment {
  id        String   @id @default(uuid()) @map("id")
  content   String
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at") // ì´ ì¤„ë„ ìˆëŠ”ì§€ í™•ì¸
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@map("comment")
}

model Like {
  userId    String
  postId    String
  createdAt DateTime @default(now()) @map("created_at")

  user      User     @relation(fields: [userId], references: [id])
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@id([userId, postId]) // userIdì™€ postIdë¥¼ ë³µí•© ê¸°ë³¸ í‚¤ë¡œ ì§€ì •
  @@map("like")
}